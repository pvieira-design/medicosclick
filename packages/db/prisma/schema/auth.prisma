model User {
  id            String    @id
  name          String
  email         String
  emailVerified Boolean   @default(false)
  image         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  sessions      Session[]
  accounts      Account[]

   // Campos especificos do ClickMedicos
   tipo          UserTipo  @default(medico)
   ativo         Boolean   @default(true)
   clickDoctorId Int?      @unique  // ID na tabela doctors do Click
   crm           String?            // CRM do médico (ex: "12345-SP")
   cpf           String?            // CPF do médico (para VIDaaS)
   enderecoConsultorio String?      // Endereço do consultório
  
  // Campos do medico
  faixa         Faixa     @default(P5)
  faixaFixa     Boolean   @default(false) // Se true, faixa é manual e não é alterada pelo recálculo de score
  score         Decimal   @default(0) @db.Decimal(5, 2)
  strikes       Int       @default(0)
  
    // Relacoes do sistema
    config                      MedicoConfig?
    horarios                    MedicoHorario[]
    solicitacoes                Solicitacao[]               @relation("solicitacoes")
    cancelamentos               CancelamentoEmergencial[]   @relation("cancelamentos")
    solicitacoesAprovadas       Solicitacao[]               @relation("solicitacoesAprovadas")
    cancelamentosProcessados    CancelamentoEmergencial[]   @relation("cancelamentosProcessados")
    observacoes                 MedicoObservacao[]          @relation("observacoesMedico")
    observacoesCriadas          MedicoObservacao[]          @relation("observacoesAutor")
    historicoScores             HistoricoScore[]            @relation("historicoScores")
    notificacoes                Notificacao[]
    
    // Relacoes de receita medica
    vidaasCredentials           VidaasCredentials?
    receitas                    Receita[]
    receitasAuditorias          ReceitaAuditoria[]
   
   // Relacoes do onboarding
   candidatosRejeitados        Candidato[]                 @relation("CandidatoRejeitadoPor")
   candidatosEntrevistados     Candidato[]                 @relation("CandidatoEntrevistador")
   candidatosAtivados          Candidato[]                 @relation("CandidatoAtivadoPor")
   candidatoTags               CandidatoTag[]              @relation("CandidatoTagCriadoPor")
   candidatoHistorico          CandidatoHistorico[]        @relation("CandidatoHistoricoUsuario")
   candidatoMentores           CandidatoMentor[]           @relation("CandidatoMentorAtribuidoPor")

  @@unique([email])
  @@index([tipo])
  @@index([faixa])
  @@index([clickDoctorId])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([token])
  @@index([userId])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@index([userId])
  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([identifier])
  @@map("verification")
}
